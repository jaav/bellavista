/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

jQuery(function($){$("#config").tabs();$("#profile").prependTo("#config li.Profiles").profiles('[data-profile="default"]');$("#config").prev("ul.nav").append('<li class="version">Warp '+$("#config").data("warpversion")+"</li>");var verify=$("#config ul.verify").hide();$("#config a.verify-link").bind("click",function(e){e.preventDefault();verify.slideToggle()});var systemcheck=$("#config ul.systemcheck").hide();$("#config a.systemcheck-link").bind("click",function(e){e.preventDefault();systemcheck.slideToggle()});$('[data-warp="theme"] input[type="submit"]').bind("click",function(e){e.preventDefault();var post={},ignore=[],form=$("#theme-options"),button=$(this);button.attr("disabled",true).parent().addClass("saving");$("#config li.ignore > .field").find("input, select, textarea").each(function(){ignore.push($(this).attr("name"))});$.each(form.serializeArray(),function(i,field){if($.inArray(field.name,ignore)>-1)return;post[field.name]=field.value});$.ajax({url:ajaxurl,type:"post",data:post,success:function(data){var success=false;button.attr("disabled",false).parent().removeClass("saving");try{data=$.parseJSON(data);if(data.message=="success"){success=true}}catch(e){}if(!success){alert("Save failed!")}}})});$('[data-warp="widget"] ul:first').tabs();$('[data-warp="widget"] input[type="submit"]').bind("click",function(e){var input=$(this);input.attr("disabled",true).parent().addClass("saving");$.post(ajaxurl,$('[data-warp="widget"] form').serialize(),function(data){input.attr("disabled",false).parent().removeClass("saving")});return false});$('[data-warp="widget"] select.widget-style').bind("change",function(e){var select=$(this);var colors=select.parent().children("select.widget-color").hide().removeAttr("name");if(select.val()){colors.filter("[data-style='"+select.val()+"']").show().attr("name",select.attr("name").replace("[style]","[color]"))}}).trigger("change")});